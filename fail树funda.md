> ### 背景
>
> 字符串 ac automata

### 模板题

> 给定n个串，m个询问，每个询问为一对(x,y),询问串y包含几个串x。

重认识：

当字符串 $y$ 有一个前缀的后缀是 $x$ ，我们称 $x$ 是 $y$ 的子串。

$u$ 的 $fail$ 指针指向 $u$ 的最长后缀。

题目即求，从 $y$ 的所有节点出发（$y$ 的前缀集合），顺着 $fail$ 指针（可能是连续的 $fail$，找后缀）能够走到 $x$ 的节点数。

不如反向思考，统计 $x$ 为根，逆$fail$ 为边的子树中有多少节点属于 $y$。将这颗树命名为 $fail$ 树。

 